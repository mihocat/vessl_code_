# 고급 통합 AI 시스템 문서

## 개요

이 시스템은 전기공학 문제 해결을 위한 거시적이고 포괄적인 AI 플랫폼입니다.

## 주요 구성 요소

### 1. 통합 AI 시스템 (integrated_ai_system.py)
- **전체 파이프라인 통합**: OCR → 문제분석 → 공식선택 → 계산 → 검증
- **문제 유형 자동 분류**: 역률, 회로해석, 임피던스 등
- **공식 기반 정확한 계산**: 전기공학 공식 데이터베이스 내장
- **물리적 타당성 검증**: 계산 결과의 물리적 유효성 확인

### 2. 고급 애플리케이션 (advanced_app.py)
- **직관적인 Gradio 인터페이스**
- **일괄 평가 시스템**: 여러 문제를 한번에 테스트
- **문제 해결 히스토리**: 모든 해결 기록 추적
- **결과 내보내기**: JSON 형식으로 결과 저장

### 3. 피드백 시스템 (feedback_system.py)
- **사용자 평점 수집**: 1-5점 척도
- **오류 패턴 분석**: 반복적인 실수 추적
- **자동 개선 제안**: 성능 향상을 위한 구체적 제안
- **적응형 학습**: 약한 영역 집중 개선

### 4. 실제 OCR 시스템 (real_ocr_system.py)
- **멀티 엔진 OCR**: EasyOCR, PaddleOCR, Tesseract
- **전기공학 특화**: 수식과 회로도 인식 최적화
- **높은 정확도**: Florence-2 대비 크게 향상된 성능

### 5. 새로운 이미지 분석기 (new_image_analyzer.py)
- **Florence-2 호환 인터페이스**: 기존 코드와 완벽 호환
- **실제 OCR 시스템 활용**: 정확한 텍스트 추출
- **비동기 처리**: 빠른 응답 속도

## 시스템 아키텍처

```
사용자 입력 (텍스트/이미지)
      ↓
[OCR 시스템] → 텍스트 추출
      ↓
[문제 분석기] → 문제 유형 분류
      ↓
[RAG 시스템] → 관련 지식 검색
      ↓
[공식 해결기] → 수학적 계산
      ↓
[LLM 설명기] → 상세 설명 생성
      ↓
[검증 시스템] → 답안 검증
      ↓
[피드백 수집] → 지속적 개선
```

## 사용 방법

### 1. 기본 모드 (기존 RAG 시스템)
```bash
export APP_MODE=basic
# 또는 run.yaml의 env 섹션에서 APP_MODE: "basic" 설정
```

### 2. 고급 모드 (통합 AI 시스템)
```bash
export APP_MODE=advanced
# 또는 run.yaml의 env 섹션에서 APP_MODE: "advanced" 설정
```

## 주요 기능

### 문제 해결
1. 이미지 업로드 또는 텍스트 입력
2. 자동 문제 분석 및 유형 분류
3. 단계별 계산 과정 표시
4. 물리적 타당성 검증
5. 상세한 설명 제공

### 일괄 평가
```json
[
  {
    "id": "test_001",
    "type": "power_factor",
    "text": "유효전력 100kW, 무효전력 50kVar일 때 역률은?",
    "expected_answer": {"value": 0.894}
  }
]
```

### 피드백 시스템
- 각 문제 해결 후 1-5점 평가
- 정답 제공 시 오류 분석
- 자동 개선 제안 생성
- 성능 보고서 출력

## 성능 개선

### OCR 정확도
- Florence-2: "L C - / ( + 20/20 10:10" (의미없는 텍스트)
- 새 시스템: 정확한 수식 인식 (예: "P = 100kW, Q = 50kVar")

### 계산 정확도
- 공식 기반 정확한 계산
- 단위 자동 변환
- 물리적 검증 포함

### 사용자 경험
- 단계별 풀이 과정
- 시각적 결과 표시
- 히스토리 추적
- 내보내기 기능

## 향후 계획

1. **더 많은 문제 유형 지원**
   - 3상 회로 해석
   - 과도 현상 분석
   - 전력 시스템 해석

2. **고급 시각화**
   - 그래프 생성
   - 회로도 그리기
   - 페이저 다이어그램

3. **AI 모델 개선**
   - 더 정교한 문제 분류
   - 복잡한 문제 해결
   - 실시간 학습

## 배포 가이드

1. run.yaml에서 APP_MODE 설정
2. 필요한 의존성은 requirements.txt에 포함됨
3. VESSL에서 배포:
```bash
vessl run create -f vessl_configs/run.yaml
```

## 문제 해결

### GPU 메모리 부족
- APP_MODE를 "basic"으로 설정
- GPU 메모리 정리 후 재시도

### OCR 인식 실패
- 이미지 품질 확인
- 이미지 크기 조정 (최대 1024x1024)
- 다른 OCR 엔진 시도

### 계산 오류
- 피드백 시스템에 정답 제공
- 오류 패턴 분석 확인
- 개선 제안 적용